name = "legaldocs-api"
main = "src/index.ts"
compatibility_date = "2024-09-23"
compatibility_flags = ["nodejs_compat_v2"]

# Browser Rendering for PDF generation (requires paid Workers plan)
# Uncomment the line below to enable Cloudflare Browser Rendering
# browser = { binding = "BROWSER" }

# Email Sending via Cloudflare Email Workers
# Requires Email Routing enabled on domain with verified destination addresses
# Uncomment and configure to enable Cloudflare Email
# For unrestricted sending to any verified address:
# send_email = [{ name = "EMAIL" }]
# For targeted sending to specific addresses:
# send_email = [
#   { name = "EMAIL_SUPPORT", destination_address = "support@qannoni.com" },
#   { name = "EMAIL_NOTIFICATIONS", destination_address = "notifications@qannoni.com" }
# ]

# Development port
[dev]
port = 4001

# Environment variables (set these in Cloudflare dashboard for production)
[vars]
ENVIRONMENT = "production"
APP_URL = "https://www.qannoni.com"

# D1 Database (Cloudflare's SQLite)
[[d1_databases]]
binding = "DB"
database_name = "legaldocs-db"
database_id = "0bea26ba-9b8e-421a-9c41-888207c42d35"

# R2 Storage
[[r2_buckets]]
binding = "STORAGE"
bucket_name = "legaldocs-storage"

# KV Namespace for caching
[[kv_namespaces]]
binding = "CACHE"
id = "62c5cf643b2a4f3eba1d2dd86330247e"

# Secrets (set via wrangler secret put)
# - JWT_SECRET
# - OPENROUTER_API_KEY
# - RESEND_API_KEY (optional fallback for email)
# - TWILIO_ACCOUNT_SID
# - TWILIO_AUTH_TOKEN
# - TWILIO_WHATSAPP_FROM (e.g., whatsapp:+14155238886)
# - CF_ACCOUNT_ID (for Browser Rendering REST API fallback)
# - CF_API_TOKEN (for Browser Rendering REST API fallback)
