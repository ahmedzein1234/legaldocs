generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ============================================
// CORE TABLES
// ============================================

model Organization {
  id            String   @id @default(cuid())
  name          String
  nameAr        String?  @map("name_ar")
  nameUr        String?  @map("name_ur")
  slug          String?  @unique
  tradeLicense  String?  @map("trade_license")
  email         String?
  phone         String?
  address       String?
  logoUrl       String?  @map("logo_url")
  plan          String   @default("free")
  planExpiresAt DateTime? @map("plan_expires_at")
  settings      Json     @default("{}")
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")

  users         User[]
  documents     Document[]
  templates     Template[]
  subscription  Subscription?
  usageRecords  UsageRecord[]

  @@map("organizations")
}

model User {
  id              String    @id @default(cuid())
  orgId           String?   @map("org_id")
  email           String    @unique
  emailVerified   Boolean   @default(false) @map("email_verified")
  phone           String?
  phoneVerified   Boolean   @default(false) @map("phone_verified")
  passwordHash    String?   @map("password_hash")
  fullName        String    @map("full_name")
  fullNameAr      String?   @map("full_name_ar")
  fullNameUr      String?   @map("full_name_ur")
  avatarUrl       String?   @map("avatar_url")
  emiratesIdHash  String?   @map("emirates_id_hash")
  role            String    @default("member")
  uiLanguage      String    @default("en") @map("ui_language")
  preferredDocLanguages String[] @default(["en", "ar"]) @map("preferred_doc_languages")
  timezone        String    @default("Asia/Dubai")
  isActive        Boolean   @default(true) @map("is_active")
  lastLoginAt     DateTime? @map("last_login_at")
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")

  organization    Organization? @relation(fields: [orgId], references: [id], onDelete: SetNull)
  sessions        Session[]
  documents       Document[]
  templates       Template[]
  whatsappSessions WhatsappSession[]
  documentActivities DocumentActivity[]

  @@map("users")
}

model Session {
  id          String   @id @default(cuid())
  userId      String   @map("user_id")
  tokenHash   String   @unique @map("token_hash")
  deviceInfo  Json?    @map("device_info")
  ipAddress   String?  @map("ip_address")
  expiresAt   DateTime @map("expires_at")
  createdAt   DateTime @default(now()) @map("created_at")

  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("sessions")
}

model VerificationCode {
  id        String   @id @default(cuid())
  email     String?
  phone     String?
  code      String
  type      String   // email_verify, phone_verify, password_reset
  expiresAt DateTime @map("expires_at")
  usedAt    DateTime? @map("used_at")
  createdAt DateTime @default(now()) @map("created_at")

  @@map("verification_codes")
}

// ============================================
// DOCUMENT TABLES
// ============================================

model Template {
  id            String   @id @default(cuid())
  orgId         String?  @map("org_id")
  createdBy     String?  @map("created_by")
  name          String
  nameAr        String?  @map("name_ar")
  nameUr        String?  @map("name_ur")
  description   String?
  descriptionAr String?  @map("description_ar")
  descriptionUr String?  @map("description_ur")
  category      String?
  contentEn     Json?    @map("content_en")
  contentAr     Json?    @map("content_ar")
  contentUr     Json?    @map("content_ur")
  variables     Json?
  isPublic      Boolean  @default(false) @map("is_public")
  isSystem      Boolean  @default(false) @map("is_system")
  usageCount    Int      @default(0) @map("usage_count")
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")

  organization  Organization? @relation(fields: [orgId], references: [id], onDelete: Cascade)
  creator       User?         @relation(fields: [createdBy], references: [id])
  documents     Document[]

  @@map("templates")
}

model Document {
  id              String    @id @default(cuid())
  orgId           String?   @map("org_id")
  createdBy       String?   @map("created_by")
  templateId      String?   @map("template_id")

  documentNumber  String    @unique @map("document_number")
  title           String
  titleAr         String?   @map("title_ar")
  titleUr         String?   @map("title_ur")
  documentType    String    @map("document_type")

  contentEn       Json?     @map("content_en")
  contentAr       Json?     @map("content_ar")
  contentUr       Json?     @map("content_ur")
  languages       String[]  @default(["en"])
  bindingLanguage String    @default("ar") @map("binding_language")

  pdfUrlEn        String?   @map("pdf_url_en")
  pdfUrlAr        String?   @map("pdf_url_ar")
  pdfUrlUr        String?   @map("pdf_url_ur")
  pdfUrlCombined  String?   @map("pdf_url_combined")

  status          String    @default("draft")

  riskScore       Int?      @map("risk_score")
  riskDetails     Json?     @map("risk_details")

  blockchainHash  String?   @map("blockchain_hash")
  blockchainTx    String?   @map("blockchain_tx")
  blockchainVerifiedAt DateTime? @map("blockchain_verified_at")

  metadata        Json      @default("{}")
  expiresAt       DateTime? @map("expires_at")
  signedAt        DateTime? @map("signed_at")
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")

  organization    Organization? @relation(fields: [orgId], references: [id], onDelete: Cascade)
  creator         User?         @relation(fields: [createdBy], references: [id])
  template        Template?     @relation(fields: [templateId], references: [id])
  signers         DocumentSigner[]
  activities      DocumentActivity[]
  blockchainRecords BlockchainRecord[]

  @@map("documents")
}

model DocumentSigner {
  id                String    @id @default(cuid())
  documentId        String    @map("document_id")

  email             String?
  phone             String?
  fullName          String    @map("full_name")
  fullNameAr        String?   @map("full_name_ar")
  role              String?

  signingOrder      Int       @default(1) @map("signing_order")
  status            String    @default("pending")

  preferredLanguage String    @default("en") @map("preferred_language")

  signatureData     Json?     @map("signature_data")
  signedAt          DateTime? @map("signed_at")
  signedIp          String?   @map("signed_ip")
  signedDevice      Json?     @map("signed_device")

  verificationLevel String    @default("none") @map("verification_level")
  verificationData  Json?     @map("verification_data")
  verifiedAt        DateTime? @map("verified_at")

  lastSentAt        DateTime? @map("last_sent_at")
  reminderCount     Int       @default(0) @map("reminder_count")
  viewedAt          DateTime? @map("viewed_at")
  declinedReason    String?   @map("declined_reason")

  signingToken      String?   @unique @map("signing_token")
  tokenExpiresAt    DateTime? @map("token_expires_at")

  createdAt         DateTime  @default(now()) @map("created_at")
  updatedAt         DateTime  @updatedAt @map("updated_at")

  document          Document  @relation(fields: [documentId], references: [id], onDelete: Cascade)
  activities        DocumentActivity[]

  @@map("document_signers")
}

model DocumentActivity {
  id          String   @id @default(cuid())
  documentId  String   @map("document_id")
  userId      String?  @map("user_id")
  signerId    String?  @map("signer_id")

  action      String
  details     Json?
  ipAddress   String?  @map("ip_address")
  userAgent   String?  @map("user_agent")

  createdAt   DateTime @default(now()) @map("created_at")

  document    Document        @relation(fields: [documentId], references: [id], onDelete: Cascade)
  user        User?           @relation(fields: [userId], references: [id])
  signer      DocumentSigner? @relation(fields: [signerId], references: [id])

  @@map("document_activities")
}

// ============================================
// WHATSAPP TABLES
// ============================================

model WhatsappSession {
  id                String    @id @default(cuid())
  userId            String?   @map("user_id")
  phone             String

  state             String    @default("idle")
  context           Json      @default("{}")

  detectedLanguage  String    @default("en") @map("detected_language")
  preferredLanguage String    @default("en") @map("preferred_language")

  lastMessageAt     DateTime? @map("last_message_at")
  createdAt         DateTime  @default(now()) @map("created_at")
  updatedAt         DateTime  @updatedAt @map("updated_at")

  user              User?     @relation(fields: [userId], references: [id])
  messages          WhatsappMessage[]

  @@map("whatsapp_sessions")
}

model WhatsappMessage {
  id            String   @id @default(cuid())
  sessionId     String   @map("session_id")

  direction     String   // inbound, outbound
  messageType   String?  @map("message_type")
  content       String?
  mediaUrl      String?  @map("media_url")
  templateName  String?  @map("template_name")

  twilioSid     String?  @map("twilio_sid")
  status        String?

  createdAt     DateTime @default(now()) @map("created_at")

  session       WhatsappSession @relation(fields: [sessionId], references: [id], onDelete: Cascade)

  @@map("whatsapp_messages")
}

// ============================================
// BLOCKCHAIN TABLES
// ============================================

model BlockchainRecord {
  id              String   @id @default(cuid())
  documentId      String   @map("document_id")

  documentHash    String   @map("document_hash")
  transactionHash String?  @map("transaction_hash")
  blockNumber     BigInt?  @map("block_number")
  chain           String   @default("polygon")
  contractAddress String?  @map("contract_address")

  status          String   @default("pending")
  gasUsed         BigInt?  @map("gas_used")

  registeredAt    DateTime @default(now()) @map("registered_at")

  document        Document @relation(fields: [documentId], references: [id], onDelete: Cascade)

  @@map("blockchain_records")
}

// ============================================
// SUBSCRIPTION & BILLING
// ============================================

model Subscription {
  id                    String    @id @default(cuid())
  orgId                 String    @unique @map("org_id")

  stripeCustomerId      String?   @map("stripe_customer_id")
  stripeSubscriptionId  String?   @map("stripe_subscription_id")

  plan                  String
  status                String    @default("active")

  currentPeriodStart    DateTime? @map("current_period_start")
  currentPeriodEnd      DateTime? @map("current_period_end")
  cancelAtPeriodEnd     Boolean   @default(false) @map("cancel_at_period_end")

  createdAt             DateTime  @default(now()) @map("created_at")
  updatedAt             DateTime  @updatedAt @map("updated_at")

  organization          Organization @relation(fields: [orgId], references: [id], onDelete: Cascade)

  @@map("subscriptions")
}

model UsageRecord {
  id                String   @id @default(cuid())
  orgId             String   @map("org_id")

  periodStart       DateTime @map("period_start")
  periodEnd         DateTime @map("period_end")

  documentsCreated  Int      @default(0) @map("documents_created")
  documentsSigned   Int      @default(0) @map("documents_signed")
  whatsappMessages  Int      @default(0) @map("whatsapp_messages")
  aiTokensUsed      BigInt   @default(0) @map("ai_tokens_used")
  storageBytes      BigInt   @default(0) @map("storage_bytes")
  idVerifications   Int      @default(0) @map("id_verifications")
  blockchainRecords Int      @default(0) @map("blockchain_records")

  createdAt         DateTime @default(now()) @map("created_at")
  updatedAt         DateTime @updatedAt @map("updated_at")

  organization      Organization @relation(fields: [orgId], references: [id], onDelete: Cascade)

  @@unique([orgId, periodStart])
  @@map("usage_records")
}

// ============================================
// LAWYER VERIFICATION SYSTEM
// ============================================

model Lawyer {
  id                    String    @id @default(cuid())
  userId                String?   @unique @map("user_id")

  // Basic Information
  firstName             String    @map("first_name")
  lastName              String    @map("last_name")
  firstNameAr           String?   @map("first_name_ar")
  lastNameAr            String?   @map("last_name_ar")
  title                 String?
  titleAr               String?   @map("title_ar")
  bio                   String?
  bioAr                 String?   @map("bio_ar")

  email                 String    @unique
  emailVerified         Boolean   @default(false) @map("email_verified")
  phone                 String?
  phoneVerified         Boolean   @default(false) @map("phone_verified")

  avatarUrl             String?   @map("avatar_url")

  // Location
  country               String    @default("AE")
  emirate               String?
  city                  String?
  address               String?
  officeAddress         String?   @map("office_address")

  // Professional Details
  yearsExperience       Int       @default(0) @map("years_experience")
  languages             String[]  @default(["en", "ar"])
  specializations       String[]  @default([])

  // Bar Association & Licensing
  barAssociation        String?   @map("bar_association")
  barLicenseNumber      String?   @unique @map("bar_license_number")
  barLicenseIssueDate   DateTime? @map("bar_license_issue_date")
  barLicenseExpiryDate  DateTime? @map("bar_license_expiry_date")

  // Pricing
  consultationFee       Int?      @map("consultation_fee")
  hourlyRate            Int?      @map("hourly_rate")
  currency              String    @default("AED")

  // Availability & Performance
  isAvailable           Boolean   @default(false) @map("is_available")
  responseTimeHours     Int       @default(24) @map("response_time_hours")
  acceptingNewClients   Boolean   @default(true) @map("accepting_new_clients")

  // Stats
  totalCasesCompleted   Int       @default(0) @map("total_cases_completed")
  totalReviews          Int       @default(0) @map("total_reviews")
  averageRating         Float     @default(0) @map("average_rating")
  successRate           Float     @default(0) @map("success_rate")

  // Verification Status
  verificationStatus    String    @default("pending") @map("verification_status") // pending, in_review, verified, rejected, suspended
  verificationLevel     String    @default("none") @map("verification_level") // none, basic, identity, professional, enhanced

  // Flags
  featured              Boolean   @default(false)
  topRated              Boolean   @default(false) @map("top_rated")
  isActive              Boolean   @default(true) @map("is_active")
  isSuspended           Boolean   @default(false) @map("is_suspended")
  suspensionReason      String?   @map("suspension_reason")

  // Admin Notes
  adminNotes            String?   @map("admin_notes")
  internalRating        Int?      @map("internal_rating") // 1-5 admin rating

  // Timestamps
  profileCompletedAt    DateTime? @map("profile_completed_at")
  verifiedAt            DateTime? @map("verified_at")
  lastActiveAt          DateTime? @map("last_active_at")
  createdAt             DateTime  @default(now()) @map("created_at")
  updatedAt             DateTime  @updatedAt @map("updated_at")

  // Relations
  user                  User?                     @relation(fields: [userId], references: [id], onDelete: SetNull)
  verifications         LawyerVerification[]
  badges                LawyerBadge[]
  documents             LawyerDocument[]
  reviews               LawyerReview[]
  cases                 LawyerCase[]
  complaints            LawyerComplaint[]
  auditLogs             LawyerAuditLog[]

  @@map("lawyers")
}

model LawyerVerification {
  id                    String    @id @default(cuid())
  lawyerId              String    @map("lawyer_id")

  // Verification Type
  verificationType      String    @map("verification_type") // email, phone, identity, professional, enhanced

  // Status
  status                String    @default("pending") // pending, in_review, verified, rejected, expired

  // Verification Data
  documentType          String?   @map("document_type") // emirates_id, passport, license, certificate, etc.
  documentNumber        String?   @map("document_number")
  documentUrl           String?   @map("document_url")
  documentBackUrl       String?   @map("document_back_url")
  documentExpiryDate    DateTime? @map("document_expiry_date")

  // For Identity Verification
  emiratesId            String?   @map("emirates_id")
  emiratesIdExpiry      DateTime? @map("emirates_id_expiry")
  passportNumber        String?   @map("passport_number")
  passportExpiry        DateTime? @map("passport_expiry")
  nationality           String?
  dateOfBirth           DateTime? @map("date_of_birth")

  // For Professional Verification
  licenseAuthority      String?   @map("license_authority") // ministry_of_justice, dubai_courts, abu_dhabi_judicial, etc.
  licenseNumber         String?   @map("license_number")
  licenseIssueDate      DateTime? @map("license_issue_date")
  licenseExpiryDate     DateTime? @map("license_expiry_date")
  practicingCertUrl     String?   @map("practicing_cert_url")

  // UAE-Specific Verification
  mojVerified           Boolean   @default(false) @map("moj_verified") // Ministry of Justice
  dubaiCourtsVerified   Boolean   @default(false) @map("dubai_courts_verified")
  adJudicialVerified    Boolean   @default(false) @map("ad_judicial_verified") // Abu Dhabi Judicial Department
  freeZoneVerified      Boolean   @default(false) @map("free_zone_verified")
  freeZoneName          String?   @map("free_zone_name")

  // Enhanced Verification (Background Check)
  backgroundCheckStatus String?   @map("background_check_status")
  backgroundCheckUrl    String?   @map("background_check_url")
  backgroundCheckDate   DateTime? @map("background_check_date")

  // References
  reference1Name        String?   @map("reference1_name")
  reference1Contact     String?   @map("reference1_contact")
  reference1Verified    Boolean   @default(false) @map("reference1_verified")
  reference2Name        String?   @map("reference2_name")
  reference2Contact     String?   @map("reference2_contact")
  reference2Verified    Boolean   @default(false) @map("reference2_verified")

  // Review Process
  reviewedBy            String?   @map("reviewed_by") // Admin user ID
  reviewedAt            DateTime? @map("reviewed_at")
  reviewNotes           String?   @map("review_notes")
  rejectionReason       String?   @map("rejection_reason")

  // Metadata
  verificationData      Json?     @map("verification_data") // Additional verification data
  externalVerificationId String?  @map("external_verification_id") // Third-party verification ID

  // Renewal
  isRenewal             Boolean   @default(false) @map("is_renewal")
  previousVerificationId String? @map("previous_verification_id")

  // Timestamps
  submittedAt           DateTime  @default(now()) @map("submitted_at")
  verifiedAt            DateTime? @map("verified_at")
  expiresAt             DateTime? @map("expires_at")

  lawyer                Lawyer    @relation(fields: [lawyerId], references: [id], onDelete: Cascade)

  @@map("lawyer_verifications")
}

model LawyerBadge {
  id                    String    @id @default(cuid())
  lawyerId              String    @map("lawyer_id")

  // Badge Type
  badgeType             String    @map("badge_type") // verification, specialization, experience, top_rated, featured
  badgeCategory         String    @map("badge_category") // trust, expertise, performance, special

  // Badge Details
  badgeName             String    @map("badge_name")
  badgeNameAr           String?   @map("badge_name_ar")
  badgeDescription      String?   @map("badge_description")
  badgeDescriptionAr    String?   @map("badge_description_ar")
  badgeIcon             String?   @map("badge_icon")
  badgeColor            String?   @map("badge_color")

  // Specific Badge Data
  // For Verification Badges
  verificationLevel     String?   @map("verification_level") // email, phone, identity, professional, enhanced

  // For Specialization Badges
  specializationArea    String?   @map("specialization_area") // real_estate, corporate, family, etc.
  certificationUrl      String?   @map("certification_url")

  // For Experience Badges
  yearsRange            String?   @map("years_range") // 5-10, 10-15, 15+

  // For Performance Badges
  performanceMetric     String?   @map("performance_metric") // rating, cases, success_rate
  performanceValue      Float?    @map("performance_value")

  // Status
  isActive              Boolean   @default(true) @map("is_active")
  isPrimary             Boolean   @default(false) @map("is_primary") // Display prominently
  displayOrder          Int       @default(0) @map("display_order")

  // Validity
  issuedBy              String?   @map("issued_by") // Admin user ID or system
  expiresAt             DateTime? @map("expires_at")
  revokedAt             DateTime? @map("revoked_at")
  revocationReason      String?   @map("revocation_reason")

  // Timestamps
  awardedAt             DateTime  @default(now()) @map("awarded_at")

  lawyer                Lawyer    @relation(fields: [lawyerId], references: [id], onDelete: Cascade)

  @@map("lawyer_badges")
}

model LawyerDocument {
  id                    String    @id @default(cuid())
  lawyerId              String    @map("lawyer_id")

  // Document Info
  documentType          String    @map("document_type") // license, certificate, id, passport, degree, reference_letter
  documentName          String    @map("document_name")
  documentUrl           String    @map("document_url")
  documentBackUrl       String?   @map("document_back_url")

  // Metadata
  fileSize              Int?      @map("file_size")
  mimeType              String?   @map("mime_type")

  // Verification
  isVerified            Boolean   @default(false) @map("is_verified")
  verifiedBy            String?   @map("verified_by")
  verifiedAt            DateTime? @map("verified_at")

  // Validity
  issueDate             DateTime? @map("issue_date")
  expiryDate            DateTime? @map("expiry_date")

  // Timestamps
  uploadedAt            DateTime  @default(now()) @map("uploaded_at")

  lawyer                Lawyer    @relation(fields: [lawyerId], references: [id], onDelete: Cascade)

  @@map("lawyer_documents")
}

model LawyerReview {
  id                    String    @id @default(cuid())
  lawyerId              String    @map("lawyer_id")
  clientId              String?   @map("client_id") // User who submitted review
  caseId                String?   @map("case_id")

  // Review Data
  rating                Int       // 1-5
  title                 String?
  comment               String?

  // Categories
  communicationRating   Int?      @map("communication_rating")
  professionalismRating Int?      @map("professionalism_rating")
  expertiseRating       Int?      @map("expertise_rating")
  valueRating           Int?      @map("value_rating")

  // Status
  isVerified            Boolean   @default(false) @map("is_verified") // Verified purchase/case
  isPublished           Boolean   @default(false) @map("is_published")
  isFeatured            Boolean   @default(false) @map("is_featured")

  // Response
  lawyerResponse        String?   @map("lawyer_response")
  respondedAt           DateTime? @map("responded_at")

  // Moderation
  isFlagged             Boolean   @default(false) @map("is_flagged")
  flagReason            String?   @map("flag_reason")
  moderatedBy           String?   @map("moderated_by")
  moderatedAt           DateTime? @map("moderated_at")

  // Timestamps
  createdAt             DateTime  @default(now()) @map("created_at")
  updatedAt             DateTime  @updatedAt @map("updated_at")

  lawyer                Lawyer    @relation(fields: [lawyerId], references: [id], onDelete: Cascade)
  case                  LawyerCase? @relation(fields: [caseId], references: [id], onDelete: SetNull)

  @@map("lawyer_reviews")
}

model LawyerCase {
  id                    String    @id @default(cuid())
  lawyerId              String    @map("lawyer_id")
  clientId              String?   @map("client_id")

  // Case Info
  caseType              String    @map("case_type") // consultation, document_review, representation
  caseTitle             String    @map("case_title")
  caseDescription       String?   @map("case_description")
  specialization        String?

  // Status
  status                String    @default("requested") // requested, accepted, in_progress, completed, cancelled

  // Pricing
  quotedAmount          Int?      @map("quoted_amount")
  finalAmount           Int?      @map("final_amount")
  currency              String    @default("AED")

  // Outcome
  outcome               String?   // successful, unsuccessful, settled
  completionNotes       String?   @map("completion_notes")

  // Timestamps
  requestedAt           DateTime  @default(now()) @map("requested_at")
  acceptedAt            DateTime? @map("accepted_at")
  completedAt           DateTime? @map("completed_at")
  cancelledAt           DateTime? @map("cancelled_at")

  lawyer                Lawyer          @relation(fields: [lawyerId], references: [id], onDelete: Cascade)
  reviews               LawyerReview[]

  @@map("lawyer_cases")
}

model LawyerComplaint {
  id                    String    @id @default(cuid())
  lawyerId              String    @map("lawyer_id")
  complainantId         String?   @map("complainant_id") // User who filed complaint

  // Complaint Details
  complaintType         String    @map("complaint_type") // misconduct, quality, ethics, communication
  subject               String
  description           String

  // Evidence
  evidenceUrls          String[]  @default([]) @map("evidence_urls")

  // Status
  status                String    @default("submitted") // submitted, under_review, resolved, dismissed
  severity              String    @default("medium") // low, medium, high, critical

  // Investigation
  assignedTo            String?   @map("assigned_to") // Admin user ID
  investigationNotes    String?   @map("investigation_notes")
  resolution            String?
  actionTaken           String?   @map("action_taken") // warning, suspension, termination, none

  // Timestamps
  submittedAt           DateTime  @default(now()) @map("submitted_at")
  reviewedAt            DateTime? @map("reviewed_at")
  resolvedAt            DateTime? @map("resolved_at")

  lawyer                Lawyer    @relation(fields: [lawyerId], references: [id], onDelete: Cascade)

  @@map("lawyer_complaints")
}

model LawyerAuditLog {
  id                    String    @id @default(cuid())
  lawyerId              String    @map("lawyer_id")

  // Action Details
  action                String    // profile_updated, verification_submitted, badge_awarded, etc.
  actionCategory        String    @map("action_category") // profile, verification, badge, status

  // Actor
  performedBy           String?   @map("performed_by") // User ID or "system"
  performedByType       String    @default("admin") @map("performed_by_type") // admin, system, lawyer

  // Changes
  changesBefore         Json?     @map("changes_before")
  changesAfter          Json?     @map("changes_after")

  // Context
  ipAddress             String?   @map("ip_address")
  userAgent             String?   @map("user_agent")
  metadata              Json?

  // Timestamp
  createdAt             DateTime  @default(now()) @map("created_at")

  lawyer                Lawyer    @relation(fields: [lawyerId], references: [id], onDelete: Cascade)

  @@map("lawyer_audit_logs")
}
